# Práticas Fila de Mensagem e Componentes Spring Web .

# Explicação sobre o projeto.

- Produtores: Os produtores são responsáveis por criar mensagens de objetos "Veiculo" e enviá-los para uma fila. Cada mensagem contém informações sobre um veículo, como nome do cliente, marca, modelo, ano, valor de venda e dados de publicação.
  
- Consumidores: Os consumidores são processos que recuperam as mensagens da fila e as processam. No código fornecido, os consumidores consomem as mensagens e adicionam cada objeto "Veiculo" a uma base de dados.

- Serviço REST: O sistema também inclui um serviço REST implementado com o Spring Boot. O serviço REST fornece um endpoint (POST) para incluir um veículo classificado na fila. Quando o serviço REST recebe uma permissão para incluir um classificado, ele cria uma mensagem contendo o objeto "Veiculo" e envia para a fila.

- Banco de Dados: O sistema utiliza um banco de dados H2 para armazenar os classificados de veículos. O consumidor recupera as mensagens da fila, processa-as e adiciona os veículos ao banco de dados.

O sistema utiliza uma fila de mensagens (como o ActiveMQ) para garantir o fluxo ordenado de dados entre os produtores, consumidores e o serviço REST.

Essa é uma visão geral do sistema e como as diferentes partes se relacionam para criar um sistema de publicação de anúncios de veículos.

Desenvolvido por: Marcelo Faro e Savio França.

# Como rodar e executa as atividades?

Para rodar o projeto, rode o seguinte comando: Abra as pastas "FILA VEICULOS/src/main/java/com/sd/filaveiculos/veiculos" e execute os arquivos:
  - FilaVeiculosApplication | Produtor | Consumidor

Quando a aplicação estiver no ar, acesse essa url: http://localhost:8080/veiculos

Para vizualizar a fila utilize o ACTIVEMQ, através do prompt de comando com o seguinte codigo: 

```
activemq start
```

Quando acessar o ACTIVEMQ pela sua url, pedirá um usuário e uma senha: 
  - usuário:admin
  - senha:admin

Caso o programa não crie o banco de dados. Vá até o arquivo import.sql copie e cole o código para o banco de dados * H2 , que deve conter as seguintes configurações:

```
Setting Name: Generic H2 (Server)
Setting Name: org.h2.Driver
JDBC URL: jdbc:h2:~/test
User Name: sa
```

Para o acesso ao banco de dados, acesse a seguinte url: http://localhost:8080/h2-console e inclua os seguintes comandos: 

```
  CREATE TABLE veiculo (
    id bigint generated by default as identity,   
    nomeCliente varchar(255),
    marcaModeloVeiculo varchar(255),
    anoModelo integer not null,
    valorVenda double not null,
    dataPublicacao timestamp,
    primary key (id)
);


INSERT INTO veiculo (nomeCliente, marcaModeloVeiculo, anoModelo, valorVenda, dataPublicacao) VALUES ('Vitor Faro', 'Porsche 411', 2023, 350000.0, '2021-09-20 12:30:00');
INSERT INTO veiculo (nomeCliente, marcaModeloVeiculo, anoModelo, valorVenda, dataPublicacao) VALUES ('Luiz', 'Renault Kwid', 2022, 32000.0, '2021-09-20 14:30:00');
INSERT INTO veiculo (nomeCliente, marcaModeloVeiculo, anoModelo, valorVenda, dataPublicacao) VALUES ('Lucas', 'Jeep Renegade', 2020, 38000.0, '2021-09-20 20:30:00');
INSERT INTO veiculo (nomeCliente, marcaModeloVeiculo, anoModelo, valorVenda, dataPublicacao) VALUES ('Mariana', 'Honda Civic', 2017, 40000.0, '2021-09-20 17:30:00');
INSERT INTO veiculo (nomeCliente, marcaModeloVeiculo, anoModelo, valorVenda, dataPublicacao) VALUES ('Carla', 'Fiat Argo', 2018, 22000.0, '2021-09-20 15:30:00');
```

# RESUMINDO O PASSO A PASSO DO FUNCIONAMENTO DO CÓDIGO.

1 - Execute a classe "FilaVeiculosApplication" para iniciar o processo spring.

2 - Execute a classe "produtor" para criar e enviar mensagens contendo objetos Veículo para a fila.

3 -  Veja o funcionamento da fila através do ActiveMQ.

4 - Em seguida, execute a classe "consumidor" para recuperar as mensagens da fila, processá-las e adicioná-las ao banco de dados.

5 - Veja o funcionamento da fila e do banco de dados.

6 - Por fim, inicie o serviço REST, que fornecerá o endpoint para inclusão de veículos classificados na fila no site através do "veiculos.html".

A ordem acima garante que as mensagens sejam enviadas para a fila antes de serem consumidas e que o serviço REST esteja em execução para receber a inscrição de inclusão de classificados.
